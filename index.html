<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.tailwindcss.com https://esm.sh https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://cdnjs.cloudflare.com; img-src 'self' data: https: blob:; font-src 'self' data: https://cdnjs.cloudflare.com https://r2cdn.perplexity.ai; connect-src 'self' https: blob: data:; worker-src 'self' blob:; media-src 'self' https://pub-1ae9a3d95ead4a65b5c663c4d43d1de2.r2.dev https://commondatastorage.googleapis.com blob:;">
    <title>3D Scrollytelling Engine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            background-color: #050505;
            color: #ffffff;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        canvas {
            display: block;
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .glass-panel {
            background: rgba(10, 10, 10, 0.7);
            backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        html.preview-mode {
            overflow-y: auto !important;
            height: auto !important;
        }

        body.preview-mode {
            overflow-y: auto !important;
            height: auto !important;
            min-height: 1000vh !important;
        }

        html.edit-mode,
        body.edit-mode {
            overflow: hidden !important;
            height: 100vh !important;
            position: fixed !important;
            width: 100% !important;
        }

        body.placing-hotspot canvas {
            cursor: crosshair !important;
        }

        ::-webkit-scrollbar {
            width: 4px;
        }

        ::-webkit-scrollbar-track {
            background: #000;
        }

        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 10px;
        }

        .ui-glow {
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.2);
        }

        /* 1. Define custom property for angle animation */
        @property --angle {
            syntax: '<angle>';
            initial-value: 0deg;
            inherits: false;
        }

        .glowing-video-container {
            position: relative;
            isolation: isolate;
            background-color: #000;
            border-radius: 24px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1px;
        }

        /* 2. Create the sweeping border effect */
        .glowing-video-container::before {
            content: '';
            position: absolute;
            inset: -4px;
            background: conic-gradient(from var(--angle, 0deg),
                    transparent 0%,
                    #fff 15%,
                    /* White sweeping light */
                    transparent 20%);
            border-radius: inherit;
            animation: rotate-glow 4s linear infinite;
            z-index: -1;
        }

        /* 3. Add the actual 'glow' blur effect */
        .glowing-video-container::after {
            content: '';
            position: absolute;
            inset: -15px;
            background: conic-gradient(from var(--angle, 0deg),
                    transparent 0%,
                    #fff 15%,
                    transparent 20%);
            border-radius: inherit;
            filter: blur(20px);
            opacity: 0.5;
            animation: rotate-glow 4s linear infinite;
            z-index: -2;
        }

        @keyframes rotate-glow {
            to {
                --angle: 360deg;
            }
        }
    </style>
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.3.1",
    "react-dom": "https://esm.sh/react-dom@18.3.1",
    "react-dom/client": "https://esm.sh/react-dom@18.3.1/client",
    "react/jsx-runtime": "https://esm.sh/react@18.3.1/jsx-runtime",
    "three": "https://esm.sh/three@0.170.0",
    "zustand": "https://esm.sh/zustand@5.0.1?deps=react@18.3.1,react-dom@18.3.1",
    "@react-three/fiber": "https://esm.sh/@react-three/fiber@8.17.10?deps=react@18.3.1,react-dom@18.3.1,three@0.170.0",
    "@react-three/drei": "https://esm.sh/@react-three/drei@9.114.0?deps=react@18.3.1,react-dom@18.3.1,three@0.170.0,@react-three/fiber@8.17.10",
    "@react-three/postprocessing": "https://esm.sh/@react-three/postprocessing@2.16.3?deps=react@18.3.1,react-dom@18.3.1,three@0.170.0,@react-three/fiber@8.17.10",
    "gsap": "https://esm.sh/gsap@3.12.5",
    "gsap/ScrollTrigger": "https://esm.sh/gsap@3.12.5/ScrollTrigger",
    "jszip": "https://esm.sh/jszip@3.10.1",
    "@google/genai": "https://esm.sh/@google/genai@1.3.0"
  }
}
</script>
</head>

<body class="edit-mode">
    <div id="root"></div>
    <script type="module" src="./index.tsx"></script>
</body>

</html>